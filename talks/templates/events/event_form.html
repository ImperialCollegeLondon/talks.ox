{% extends "base.html" %}
{% load bootstrap %}
{% load staticfiles %}

{% block title %}Create Event{% endblock %}

{% block extrahead %}
<script src="{% static "js/create-event.js"%}"></script>

<!-- Date picker -->
<link href="{% static "css/bootstrap-datetimepicker.css"%}" rel="stylesheet">

<script src="{% static "js/bootstrap-datetimepicker.js"%}"></script>

<script>
    document.locationConfig = {
        suggestURL: "{{ event_form.location.field.endpoint }}?{% for type in event_form.location.field.types %}type_exact={{ type }}&{% endfor %}",
    };
    document.organisationConfig = {
        suggestURL: "{{ event_form.department_organiser.field.endpoint }}?{% for type in event_form.department_organiser.field.types %}type_exact={{ type }}&{% endfor %}",
    };
    document.topicConfig = {
        suggestURL: "{{ event_form.topics.field.endpoint }}"
    }
    document.speakerConfig = {
        suggestURL: "{% url 'suggest-speaker' %}",
        createURL: "{% url 'create-speaker' %}",
    };
</script>

<!-- Typeahead.js -->
<script src="{% static "js/typeahead.bundle.js"%}"></script>

<!-- our Typeahead styling -->
<link href="{% static "css/typeahead.css"%}" rel="stylesheet">

<!-- form media -->
{{ speaker_form.media }}
{{ event_form.media }}
{% endblock extrahead %}

{% block content %}

<h1>Add Talk</h1>
<form class="form-horizontal" action="{% url 'create-event' %}" method="post">{% csrf_token %}
    {{ event_form.speakers }}
    {{ event_form.location }}
    {{ event_form.topics }}
    {{ event_form.department_organiser }}
    {{ event_form.title|bootstrap_horizontal }}
    <div class="form-group">
        <label class="control-label col-sm-2 col-lg-2 " for="id_event-group">Group</label>
        <div class="col-sm-10">
            <div class="checkbox">
                    <label>
                        <input autocomplete="off" id="id_event-group-enabled" name="event-group-enabled" type="checkbox"> <span>This talk is part of seminar series or conference</span>
                    </label>
            </div>
        </div>
    </div>
    <div class="form-group event-group" style="display:none;">
        <div class="col-sm-offset-2 col-sm-10">
            {{ event_form.group }}
        </div>
    </div>
    {{ event_form.start|bootstrap_horizontal }}
    {{ event_form.end|bootstrap_horizontal }}
    {{ event_form.description|bootstrap_horizontal }}
    {{ event_form.location_suggest|bootstrap_horizontal }}
    {{ event_form.department_suggest|bootstrap_horizontal }}

    <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
        <div class="list-group js-topics-list">
            {% for topic in selected_topics %}
            <a href="#" data-id="{{ topic.uri }}" class="list-group-item list-group-item-info fade in">
                <span class="badge">-</span>{{ topic.name }}
            </a>
            {% endfor %}
        </div>
    </div>
    {{ event_form.topic_suggest|bootstrap_horizontal }}

    <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
        <div class="list-group js-suggested-topics-list">
        </div>
    </div>

    <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
        <div class="list-group js-speakers-list">
            {% for speaker in selected_speakers %}
            <a href="#" data-id="{{ speaker.id }}" class="list-group-item list-group-item-info fade in">
                <span class="badge">-</span>{{ speaker.name }} - {{ speaker.email_address }}
            </a>
            {% endfor %}
        </div>
    </div>
    {{ event_form.speaker_suggest|bootstrap_horizontal }}

    <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
        <div class="list-group js-suggested-speakers-list">
        </div>
    </div>

    <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
        <div class="panel panel-default">
            <div class="panel-heading">
                <a href="#" class="js-create-speaker">Create new speaker</a>
            </div>
            <div class="panel-body js-speaker-panel hidden">
                <div class="js-speaker-form form-inline">
                    {{ speaker_form|bootstrap_horizontal }}
                    <a class="btn btn-primary js-submit-speaker">Add</a>
                </div>
                <div class="js-speaker-form-errors alert alert-danger hidden">
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-lg-offset-2 col-sm-10 col-lg-10">
                <button type="submit" name="another" value="true" class="btn btn-default">
                    <span class="glyphicon glyphicon-plus"></span>
                    Save and add another Talk
                </button>
                <button type="submit" class="btn btn-primary">Done</button>
            </div>
        </div>
    </form>
    {% endblock %}
